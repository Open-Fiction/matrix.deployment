

Initial setup:


Docker:

1. Create a docker network for the matrix applications.

```
sudo docker network create --driver=bridge --subnet=10.10.10.0/24 --gateway=10.10.10.1 matrix_net
```

via [#1](https://github.com/AmirDez/matrix-on-premise)

Generate a homeserver.yml from scratch:

This will create a new homeserver.yml, yourdomain.log.config, and yourdomain.signing.key in the synapse folder.

```
sudo docker run -it --rm \
    -v "synapse:/data" \
    -e SYNAPSE_SERVER_NAME=m.example.com \
    -e SYNAPSE_REPORT_STATS=yes \
    matrixdotorg/synapse:latest generate
```

Creating the admin user:

1. Access docker shell

```
sudo docker compose exec -it synapse bash
```

2. Register user

```
register_new_matrix_user -c /data/homeserver.yaml http://localhost:8008
```

Deploy

```
sudo docker-compose up -d
```

Undeploy

```
sudo docker-compose up -d
```

(note: If you get "address is already available" re-run docker-compose down and up again until it works)

