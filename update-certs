# /bin/bash

# Run to create or update the certificates stored in nginx/config/sslcerts

MAIN_DOMAIN=matrix.openfiction.net
ALL_DOMAINS=$MAIN_DOMAIN,synapse.openfiction.net,cinny.openfiction.net

# Run the first time to make sure you have an account with the acl
# sudo certbot register --agree-tos

sudo certbot certonly --webroot --agree-tos -d $ALL_DOMAINS

sudo ln -fs /etc/letsencrypt/live/$MAIN_DOMAIN/privkey.pem nginx/config/sslcerts/privkey.pem
sudo ln -fs /etc/letsencrypt/live/$MAIN_DOMAIN/fullchain.pem nginx/config/sslcerts/fullchain.pem
sudo chown root:root nginx/config/sslcerts/*
